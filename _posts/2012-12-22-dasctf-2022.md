---
title: DASCTF 2022
categories:
- DASCTF
excerpt: |
  
---


### Challenge

```python
from Crypto.Util.number import *
from gmpy2 import *

FLAG = b'DASCTF{xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx}'


p = getPrime(512)
q = getPrime(512)

n1 = p*q

q2 = getPrime(512)
n2 = p*q2

e1 = getPrime(45)
e2 = getPrime(45)

c1 = powmod(bytes_to_long(FLAG), e1, n1)
c2 = powmod(bytes_to_long(FLAG), e2, n2)

print('n1=',n1)
print('n2=',n2)
print('c1=',c1)
print('c2=',c2)
print('e1=',e1)
print('e2=',e2)

'''
n1= 76629540771314723432609029363460211536776324466334269038355404901278600930324178539399192110234240008168654811465685423409791425247659859355617644885459799692619877016688744212723360718565619564663088110872729300896853740080452073352347186985345145046029352747193729181956351823771543226964671573276329412013
n2= 78503120752878913860490246164607374680859314150142764530719866448767412854988189949274223637151021223629811625083529666926419324886029023049069237155168160834111125122406167155446465373841707905692708313661831611686897588991886947429964726429974785391724096795199467935738955895596033874199316246967718603799
c1= 64257574699804746034312724739911554092913239234090879288164274120238781472755359567267587929792971928967309142343752637254817374280771236298249991637821967204511070706873387970460637248488667408361567883105196347560153197224703492834753012456011349518222335312259612019280475955641300179270885062217391267655
c2= 46969729390923163243108804318186037502836930886558479407914362634132700908726538448687931567325086970674968889802077565679877050518631115039358482496465959812073755018022034189450875105664230732477034498644216866798324432699671109130715471019824874353986136599743110130002785245541745222681809172420644026934
e1= 18617471145609
e2= 16875896916459
'''
```

### Solution

```python
from Crypto.Util.number import long_to_bytes

n1= 76629540771314723432609029363460211536776324466334269038355404901278600930324178539399192110234240008168654811465685423409791425247659859355617644885459799692619877016688744212723360718565619564663088110872729300896853740080452073352347186985345145046029352747193729181956351823771543226964671573276329412013
n2= 78503120752878913860490246164607374680859314150142764530719866448767412854988189949274223637151021223629811625083529666926419324886029023049069237155168160834111125122406167155446465373841707905692708313661831611686897588991886947429964726429974785391724096795199467935738955895596033874199316246967718603799
c1= 64257574699804746034312724739911554092913239234090879288164274120238781472755359567267587929792971928967309142343752637254817374280771236298249991637821967204511070706873387970460637248488667408361567883105196347560153197224703492834753012456011349518222335312259612019280475955641300179270885062217391267655
c2= 46969729390923163243108804318186037502836930886558479407914362634132700908726538448687931567325086970674968889802077565679877050518631115039358482496465959812073755018022034189450875105664230732477034498644216866798324432699671109130715471019824874353986136599743110130002785245541745222681809172420644026934
e1= 18617471145609
e2= 16875896916459

# solved with help of @naul

p = gcd(n1, n2)
q1 = n1 // p
q2 = n2 // p

#flag is small
#check if can solve with one factor

print(gcd(p-1, e1))
print(gcd(p-1, e2))
print(gcd(q1-1, e1))
print(gcd(q2-1, e2))

#only q2 will work
q2_roots = mod(c2, q2).nth_root(e2, all=True)

flag = q2_roots[0]
flag = long_to_bytes(int(flag))
print(flag.decode())
#DASCTF{1d86d07076bff93136ac60bbe61274d7}
```
