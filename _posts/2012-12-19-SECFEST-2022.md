---
title: SECFEST 2022
categories:
- Security Fest CTF
excerpt: |
  
---

Challenge files [here](https://github.com/Connor-McCartney/CTF-files/tree/main/SECFEST-2022)

### panta fler

Here 3 messages are XOR'd with the random key. <br>
Using the flag format and XORing byte by byte we can slowly guess the flag (changing key and increasing len).

```python
from Crypto.Util.strxor import strxor
from Crypto.Util.number import *
from string import printable

def is_printable(flag):
    for c in flag:
        if chr(c) not in  printable[:63] + "_" + " " + "}":
            return False
    return True

c1= b'\xc1=\x01}\xe7\x1c\x94YRj\xb3\xa7K@\xde\x0c\x9a\xc9\x00\xb0ZB\r\x87\r\x8b\x8f\xffQ\xc7'
c2= b'\xfc\x1d4^\xd0o\xb2GE|\x89\xe4^]\xcfE\x86\xdd\x1e\x8a\r@\x1c\x96r\x92\x87\xec\x19\xd4'
c3= b'\xfa\x19!P\x82;\xa8G\x10\x7f\x80\xa5DP\xdeE\x94\xc8S\x9cHH\x1f\x8a!\x87\xc0\xe3\x1f\xcd'

len = 8
key = strxor(c1[:len], b"SECFEST{")

for i in range(256):
    m1 = long_to_bytes(i ^ c1[len])
    m2 = long_to_bytes(i ^ c2[len])
    m3 = long_to_bytes(i ^ c3[len])
    if is_printable(m1) and is_printable(m2) and is_printable(m3):
        print(strxor(key, c1[:len]) + m1)
        print(strxor(key, c2[:len]) + m2)
        print(strxor(key, c3[:len]) + m3)
        print()
```

Eventually you can get: 

```
b'SECFEST{be_cautious_with_xor!}'
b'never reuse the same key again'
b'hack the planet at secfest now'
```
