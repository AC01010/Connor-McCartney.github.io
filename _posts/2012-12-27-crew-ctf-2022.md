---
title: Crew CTF 2022
categories:
- Crew CTF
excerpt: |
  
---

Challenge files [here](https://github.com/Connor-McCartney/CTF-files/tree/main/CrewCTF2022).
	
### The HUGE e

In this challenge I used the fact that p-1 was smooth to <br>
find the large value e1 ** e2 ** e3 (mod p-1)

<https://math.stackexchange.com/questions/81228/modular-exponentiation-by-hand-ab-bmod-c>

```python
from Crypto.Util.number import *

p = 127557933868274766492781168166651795645253551106939814103375361345423596703884421796150924794852741931334746816404778765897684777811408386179315837751682393250322682273488477810275794941270780027115435485813413822503016999058941190903932883823
e1 = 219560036291700924162367491740680392841
e2 = 325829142086458078752836113369745585569
e3 = 237262361171684477270779152881433264701
c = 962976093858853504877937799237367527464560456536071770645193845048591657714868645727169308285896910567283470660044952959089092802768837038911347652160892917850466319249036343642773207046774240176141525105555149800395040339351956120433647613

#factors of p-1
factors = [2, 525923, 527179, 561343, 589289, 593111, 641167, 642049, 650911, 659999, 
                683273, 716783, 722333, 723529, 735997, 743657, 744959, 745201, 765229, 768727, 
                769781, 791309, 811729, 815809, 836609, 845771, 850807, 862369, 887233, 912337, 
                915479, 931487, 953399, 961817, 968761, 993103, 1002109, 1023163, 1024277, 1025741, 
                1025839, 1028263]
phi = 1
for i in factors:
        phi *= i-1
#phi of (p-1)

# in this challenge we need a value for e mod p-1, in order 
# to find inverse(e, p-1) (where e = e1**e2**e3)
e = pow(e1, pow(e2, e3, phi), p-1)

m = pow(c,inverse(e,p-1),p)
print(long_to_bytes(m))
#crew{7hi5_1s_4_5ma11er_numb3r_7han_7h3_Gr4ham_numb3r}
```
