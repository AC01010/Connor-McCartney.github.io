---
title: RSA Writeups Starter
categories:
- CryptoHack
excerpt: |
  
---

This is my writeup of the [CryptoHack RSA challenges](https://cryptohack.org/challenges/rsa).


### RSA Starter 1

Find the solution to 101<sup>17</sup> mod 22663.


SOLUTION <br>
Use the python pow function - pow(base, exponent, modulus)
```python
print(pow(101, 17, 22663))
```
This gives 19906.

### RSA Starter 2

"Encrypt" the number 12 using the exponent e = 65537 and the primes p = 17 and <br>q = 23. What number do you get as the ciphertext?


SOLUTION

We need to calculate the ciphertext number, let's call that c. 

We are given the number 12 to encrypt, usually this is part of a message so let's call that m. 

N = p x q = 17 * 23

In RSA, c = m<sup>e</sup> mod N.

We can calculate this in python:
```python
m = 12
N = 17*23
e = 65537

c = pow(m, e, N)
print(c)
```
This gives c = 301.

### RSA Starter 3
Given p = 857504083339712752489993810777 and <br>q = 1029224947942998075080348647219, what is the Euler totient of N?

SOLUTION

The Euler's totient of N, also known as phi(N) can be calculated as <br> 
phi = (p - 1) x (q - 1).
```python
p = 857504083339712752489993810777
q = 1029224947942998075080348647219
phi = (p - 1) * (q - 1)
print(phi)
```
This gives <br>phi = 882564595536224140639625987657529300394956519977044270821168.

### RSA Starter 4

Given <br>
p = 857504083339712752489993810777 <br>
q = 1029224947942998075080348647219 <br>
e = 65537

What is the private key d?

SOLUTION

In RSA, d = e<sup>-1</sup> mod phi(N).<br>
The numbers are the same as the last question, so we already know phi.
```python
phi = 882564595536224140639625987657529300394956519977044270821168 
e = 65537
d = pow(e, -1, phi)
print(d)
```
This gives <br>d = 121832886702415731577073962957377780195510499965398469843281 

### RSA Starter 5

Given <br>
N = 882564595536224140639625987659416029426239230804614613279163 <br> 
e = 65537 <br>
c = 77578995801157823671636298847186723593814843845525223303932 <br>
d from previous challenge <br>
(d = 121832886702415731577073962957377780195510499965398469843281)
Decrypt the cipher text. 

SOLUTION

The formula to decrypt RSA and get the message m is <br>
m = c<sup>d</sup> mod N.
```python
N = 882564595536224140639625987659416029426239230804614613279163
c = 77578995801157823671636298847186723593814843845525223303932
d = 121832886702415731577073962957377780195510499965398469843281
m = pow(c,d,N)
print(m)
```
This gives m = 13371337. 

### RSA Starter 6
Sign the flag crypto{Immut4ble_m3ssag1ng} using your private key and the SHA256 hash function. <br>
Enter the signature as hex. <br>
In the private.key file you can download, <br>
N = 15216583654836731327639981224133918855895948374072384050848479908982286890731769486609085918857664046075375253168955058743185664390273058074450390236774324903305663479046566232967297765731625328029814055635316002591227570271271445226094919864475407884459980489638001092788574811554149774028950310695112688723853763743238753349782508121985338746755237819373178699343135091783992299561827389745132880022259873387524273298850340648779897909381979714026837172003953221052431217940632552930880000919436507245150726543040714721553361063311954285289857582079880295199632757829525723874753306371990452491305564061051059885803<br>
d = 11175901210643014262548222473449533091378848269490518850474399681690547281665059317155831692300453197335735728459259392366823302405685389586883670043744683993709123180805154631088513521456979317628012721881537154107239389466063136007337120599915456659758559300673444689263854921332185562706707573660658164991098457874495054854491474065039621922972671588299315846306069845169959451250821044417886630346229021305410340100401530146135418806544340908355106582089082980533651095594192031411679866134256418292249592135441145384466261279428795408721990564658703903787956958168449841491667690491585550160457893350536334242689

SOLUTION

First hash crypto{Immut4ble_m3ssag1ng} using sha256. <br>
I used the online tool https://emn178.github.io/online-tools/sha256.html. <br>
Now we have a hash: <br>
H = 99b4c7bb814cc630c4199e4814ffed85a835f64ffc82aadaa6388d9df9aeb2cb.<br>

Next, convert H to decimal. <br>
Then, 'encrypt' H. The formula to sign the hash is (S = H<sup>d</sup> mod N). <br>
Finally, convert S from decimal to hex. 

```python
d = 11175901210643014262548222473449533091378848269490518850474399681690547281665059317155831692300453197335735728459259392366823302405685389586883670043744683993709123180805154631088513521456979317628012721881537154107239389466063136007337120599915456659758559300673444689263854921332185562706707573660658164991098457874495054854491474065039621922972671588299315846306069845169959451250821044417886630346229021305410340100401530146135418806544340908355106582089082980533651095594192031411679866134256418292249592135441145384466261279428795408721990564658703903787956958168449841491667690491585550160457893350536334242689
N = 15216583654836731327639981224133918855895948374072384050848479908982286890731769486609085918857664046075375253168955058743185664390273058074450390236774324903305663479046566232967297765731625328029814055635316002591227570271271445226094919864475407884459980489638001092788574811554149774028950310695112688723853763743238753349782508121985338746755237819373178699343135091783992299561827389745132880022259873387524273298850340648779897909381979714026837172003953221052431217940632552930880000919436507245150726543040714721553361063311954285289857582079880295199632757829525723874753306371990452491305564061051059885803

H = "99b4c7bb814cc630c4199e4814ffed85a835f64ffc82aadaa6388d9df9aeb2cb"
H = int(H, 16) #convert from hex to decimal

S = pow(H, d, N) #sign hash
print(hex(S)) #convert decimal to hex
```
This gives:
6ac9bb8f110b318a40ad8d7e57defdcce2652f5928b5f9b97c1504d7096d7af1d34e477b30f1a08014e8d525b14458b709a77a5fa67d4711bd19da1446f9fb0ffd9fdedc4101bdc9a4b26dd036f11d02f6b56f4926170c643f302d59c4fe8ea678b3ca91b4bb9b2024f2a839bec1514c0242b57e1f5e77999ee67c450982730252bc2c3c35acb4ac06a6ce8b9dbf84e29df0baa7369e0fd26f6dfcfb22a464e05c5b72baba8f78dc742e96542169710918ee2947749477869cb3567180ccbdfe6fdbe85bcaca4bf6da77c8f382bb4c8cd56dee43d1290ca856318c97f1756b789e3cac0c9738f5e9f797314d39a2ededb92583d97124ec6b313c4ea3464037d3
