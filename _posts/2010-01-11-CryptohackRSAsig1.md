---
title: RSA - Signatures Part 1
categories:
- CryptoHack
excerpt: |
  
---

This is my writeup of the [CryptoHack RSA challenges](https://cryptohack.org/challenges/rsa).


### Signing Server

Connect at nc socket.cryptohack.org 13374. <br>
Send: <br>
```
{"option":"get_secret"}
```
We get 0x36616f25259cd2f073ce920144b1054d891fcd20cf243c4fc0bac556b5d7240fe92d8a19db7cfcee183c64f29585226521189b3d1c8be02d79ee754856cf1efae8a136cb02e045edd3f44b704a759f756574db89571b4b2fc3e52258ff15224e93072360afd7cea95d81029bc59f400dc1492597b958b8183c87a07a909b7ab407d44e5f65875e8b94585bbc60662a022e0c5edb18a28746ead4b8f8247cb80012d53a04ffa720cb10de0927f21a1334a49f5dae246d659672f8ff27703a52412dc9291f4ea50edd0d53a61cd8032336b3e416496bf2c424154018d2793c2d778c83fc245d8fabad2053d3e77767ba0feb3c094887e5424efbf5c5f02f618ec5.

Now send:
```
{"option": "sign", "msg": "0x36616f25259cd2f073ce920144b1054d891fcd20cf243c4fc0bac556b5d7240fe92d8a19db7cfcee183c64f29585226521189b3d1c8be02d79ee754856cf1efae8a136cb02e045edd3f44b704a759f756574db89571b4b2fc3e52258ff15224e93072360afd7cea95d81029bc59f400dc1492597b958b8183c87a07a909b7ab407d44e5f65875e8b94585bbc60662a022e0c5edb18a28746ead4b8f8247cb80012d53a04ffa720cb10de0927f21a1334a49f5dae246d659672f8ff27703a52412dc9291f4ea50edd0d53a61cd8032336b3e416496bf2c424154018d2793c2d778c83fc245d8fabad2053d3e77767ba0feb3c094887e5424efbf5c5f02f618ec5"}
```
We get 0x544f444f3a206175646974207369676e696e672073657276657220746f206d616b6520737572652074686174206d6564646c696e67206861636b657220646f65736e27742067657420686f6c64206f66206d792073656372657420666c61673a2063727970746f7b64306e375f3531366e5f6a7535375f346e793768316e367d.

Now decode the hex:
```python
from binascii import unhexlify
print(unhexlify("544f444f3a206175646974207369676e696e672073657276657220746f206d616b6520737572652074686174206d6564646c696e67206861636b657220646f65736e27742067657420686f6c64206f66206d792073656372657420666c61673a2063727970746f7b64306e375f3531366e5f6a7535375f346e793768316e367d").decode())
#TODO: audit signing server to make sure that meddling hacker doesn't get hold of my secret flag: crypto{d0n7_516n_ju57_4ny7h1n6}
```

### Let's Decrypt

Connect at nc socket.cryptohack.org 13391. <br>
First send:
```
{"option":"get_signature"}
```
This returns n, e, and signature 10826017069878645400727755999235136003903416920168174188295821038773919839147771043015405269042652889278667845637798637887716889466122925983469939829156480504433718543140787080835369873663688161568130278067968162696613489895172620062094378772686883697604319597903485846393638153408522460354619110965051516030399411670998825078412503334161390916851600466615561004837627289597318734287141769569578675947074707130339210036012517552534775446413293616722862279332739418900563546893933394256325041268733599700925021163994783882378431871007329541991992106832350088481475626779975723071126769170273329728748911641177338847608. I assumed this corresponded to the message in the challenge script. I tested this by sending:

```
{"option":"verify", "msg":"We are hyperreality and Jack and we own CryptoHack.org", "N":"0x80a5b8245992f64d2d11f1279a88d23dd76594fa0a37427e55482c819fe6eb727f7cde0a715c018f8e3c98cc721ff1f779e8c704f3ad2ce877eaecf680c7105685581ac1dc8d5040d602a47d8dba333e787599a7528154f8f72581f1119c1c1267078e8bfb4e2a67b00ad13827660381b8105590a72b7d1fa45bdd2c07cc12ab2d8f7c6578178e93aac1a29ccdd1ecbeeafa25fa425988376384f745a7613af437ad235826d7d1499a0b2e83401ce0781fb85aa801ae9c43a9f79b2bd4bc8817a2a0725272e847e3b397e1d27b86fa0ba038b2704534a98a12e5e133f2358521ee0ee59a892928543c4a71460cadc2c89e011b019c2094ca6d17a0c143dc9297", "e":"0x10001"}
```
This returns "Ownership verified." so my guess was right. Now we have m we can work with.

```python
bytes2long = lambda x: int.from_bytes(x, 'big') 
from pkcs1 import emsa_pkcs1_v15
MSG = 'We are hyperreality and Jack and we own CryptoHack.org'
DIGEST = emsa_pkcs1_v15.encode(MSG.encode(), 256)
print(bytes2long(DIGEST))
```

s = m1<sup>?</sup> mod n <br>
s = m2<sup>?</sup> mod n
